

<!DOCTYPE html>
<html>
<head>
	<link href="https://corescript.neocities.org/favicon.png" rel="icon">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">
	</script>
	<script src="https://code.jquery.com/jquery-1.12.4.js">
	</script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js">
	</script>

	<title>CoreScript 1.0.0</title>
</head>
<body>
	<div id="menu">
		<button class="runbutton" id="runbutton" onclick="runcode()" title="Run">Run</button> <button class="runbutton2" id="runbutton" onclick="save()" title="Save">Save</button> <button class="runbutton3" id="runbutton" onclick="document.getElementById('fileInput').click()" title="Open">Open</button> <button class="runbutton4" id="runbutton" onclick="share()" title="Share">Share</button> <button class="runbutton5" id="runbutton" onclick="settings()" title="Settings">Settings</button>
	</div>
	<div id="main">
		<div id="lines">
		<div style="line-height:14%;">
			<br>
		</div>
		<div id="codelines"></div>
	</div>
	<textarea id="code" onkeydown=""></textarea>
	<div id="outputbox">
		<p id="output"></p>
	</div>
	</div>
	<div id="popup">
		<div id="draggy" style="width: 100%; height: 20px; border: transparent; background-color: lightgrey; cursor: move;">
			<button class="close" onclick='document.getElementById("popup").style.visibility = "hidden";'>X</button>
		</div>
		<p id="popuptext"></p>
	</div>
	<div id="console"></div>
	<form>
		<input accept=".corescript" id="fileInput" multiple="false" style="display:none;" type="file"> 
		<script>
		// Declare Variables
		var lastcode = [];
		var batch = ["@echo off", "title Corescript File"]
		var builder = false; 
		var builder_compiled = ["<!-- Corescript Advanced Styles Plugin -->", "<title>Corescript Styles<\/title>"];
		var frombutton = false;
		var q_ = q + 1;
		var aaaa = "// nothing";
		var result_1 = "// Nothing";
		var codel = document.querySelector('#code');
		var codelinesl = document.querySelector('#codelines');
		var gotolimit = 0;
		var draw = false;
		var boxnum = 1;
		var q = 0;
		var t;
		var i;
		var o;
		var p;
		var e;
		var printa = [];
		var current;
		var variablecolumn = 1;
		var printpend;
		var currentvar = "";
		var linedoing = true;
		var codelist = "";
		var thei = 0;
		// Update Popup
	popup("<h3>What's new? Version 1.0.0<\/h3><ul><li>Lots of bug fixes :)<\/li> <li>Corescript is out of BETA!!!!! WOOOHOOOOO!<\/li><\/ul>");
		function runcode() {
			//alert(thei + "  " + i + "  " + frombutton); // Info 4 meee
		if (frombutton) {
// from a button, don't set line to 0
} else {
// Not from a button, set line to 0

document.getElementById('output').innerHTML = "";
}

		builder_compiled = ["<!-- Created Using Corescript's Website Builder -->", "<title>Corescript Website<\/title>"];
		eval(aaaa);
		gotolimit = 0;
		var valueof = document.getElementById('code').value;
		codelist = $(code).val().split('\n');
		for (i = thei; i < codelist.length; i++) {
		      current = codelist[i];
		      var current2 = current;
		      // Every Command
		      var print = current.startsWith('print ');
		      var note = current.startsWith("//");
		      var set = current.startsWith("var ");
		      var printf = current.startsWith("printf "); // not used
		      var input = current.startsWith("input ");
		      var draw = current.startsWith("draw"); // not used
		      var pen = current.startsWith("pen "); // Not used
		      var cls = current.startsWith("cls");
		      var msg = current.startsWith("msg ");
		      var setit = current.startsWith("set ");
		      var wait = current.startsWith("wait ");
		      var ifelse = current.startsWith("if ");
		      var gotoo = current.startsWith("goto ");
		      var play = current.startsWith('play ');
		      var ifnot = current.startsWith('not ');
		      var stop = current.startsWith('stop');
		      var button = current.startsWith('button ');
		      // Website Builder
		      var text = current.startsWith('text ');
		      var title = current.startsWith("title ");
		      var image = current.startsWith("img ");
		      if (print) {
		          var s1 = current.substring(6);
		          var s1n = s1.replace(/{br}/g, "<br>");
		          var s1split = s1n.split("");
		          // Look for ( variable then stop at )
		          for (p = 0; p < s1split.length; p++) {
		              if (s1split[p] == "(") {
		                  var variable1 = s1n.match(/\(([^)]+)\)/)[1];
		                  s1n = s1n.replace("(" + variable1 + ")", eval(variable1));
		              } else {}
		          }
		          document.getElementById('output').innerHTML = document.getElementById('output').innerHTML + "<span>" + s1n + "<\/span><br>";
		          batch.push("echo " + s1n);
		      } else if (note) {
		          current = codelist[i];
		          var s2 = current.substring(2);
		          batch.push("rem " + s2);
		          console(s2);
		      } else if (set) {
		          // set name=Hello
		          current = codelist[i];
		          //name=hello
		          var s3 = current.substring(4);
		          // hello
		          var val = s3.split('=')[1]; // Input Value
		          var nam = s3.split('=')[0]; // Input Name
		          if (val.startsWith("(")) {
		              var val2 = val.substring(1);
		              if (val.endsWith(")")) {
		                  var val3 = val2.slice(0, -1);
		                  val = eval(val3);
		              }
		          }
		         
		          window[nam] = val;
		      } else if (printf) {
		          var s4 = current.substring(7);
		          document.getElementById('output').innerHTML = document.getElementById('output').innerHTML + "<span>" + eval(s4) + "<\/span>";
		      } else if (input) {
		          // input name=Hello
		          current = codelist[i];
		          //name=hello
		          var s5 = current.substring(6);
		          // hello
		          var ival = s5.split('=')[1]; // Input Value
		          var inam = s5.split('=')[0]; // Input Name
		          window[inam] = prompt(ival);
		      } else if (draw) {
		          document.getElementById('output').innerHTML = "";
		          o = 0;
		          boxnum = 1;
		          draw = false;
		          current = codelist[i];
		          draw = true;
		          for (o = 0; o < 200; o++) {
		              var box = "<span id='" + boxnum + "'> <img style='height:20px;' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAOSURBVChTYxgFJAMGBgABNgABY8OiGAAAAABJRU5ErkJggg=='><\/span>";
		              boxnum = boxnum + 1;
		              document.getElementById('output').innerHTML = document.getElementById('output').innerHTML + box;
		          }
		      } else if (pen) {
		          current = codelist[i];
		          var s6 = current.substring(4);
		          document.getElementById(eval("s6")).innerHTML = '<img  style="height:20px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYSURBVChTY/z//z8DbsAEpXGAkSnNwAAApeMDEUEua14AAAAASUVORK5CYII=">';
		      } else if (cls) {
		          document.getElementById("output").innerHTML = "";
		      } else if (msg) {
		          var s7 = current.substring(4);
		          var s7split = s7.split("");
		          // Look for ( variable then stop at )
		          for (t = 1; t < s7split.length; t++) {
		              if (s7split[t] == "(") {
		                  var variable12 = s7.match(/\(([^)]+)\)/)[1];
		                  s7 = s7.replace("(" + variable12 + ")", eval(variable12));
		              } else {}
		          }
		          alert(s7);
		      } else if (setit) {
		          // set score=score + 1
		          current = codelist[i];
		          //name=hello
		          var s8 = current.substring(4);
		          // hello
		          var val8 = s8.split('=')[1]; // Input Value
		          var nam8 = s8.split('=')[0]; // Input Name
		          if (val8.startsWith("(")) {
		              var val18 = val8.substring(1);
		              if (val8.endsWith(")")) {
		                  var val3 = val18.slice(0, -1);
		                  val8 = eval(val3);
		              }
		          }
		          eval("var " + nam8 + " = " + "'" + val8 + "'");
		          console.log("Set " + nam8 + " to " + val8);
		      } else if (ifelse) {
		          var ifend = true;
		          var ended = true;
		          //if name=johndoe 1
		          //name=johndoe 1
		          var s91 = current.split('=')[1]; //johndoe 1
		          var s92 = current.split('=')[0]; //if name
		          var s94 = s92.split(' ')[1]; //name
		          var s93 = s91.split(' ')[0]; //johndoe
		          var s95 = s91.split(' ')[1]; //johndoe
		          eval("if (" + s94 + " == '" + s93 + "') {ifend=true;} else {ifend=false;}");
		          if (ifend) {
		              var ie2 = +s95 - 2;
		              i = ie2;
		          } else {}
		      } else if (current == "") {} else if (gotoo) {
		          gotolimit++;
		          var s101 = current.substring(5);
		          if (gotolimit > 1000) {
		              alert("Goto limit of 1000 reached");
		          } else {
		              var ie = +s101 - 2;
		              i = ie;
		          }
		      } else if (play) {
		          current = codelist[i];
		          var s11 = current.substring(5);
		          var string = isNaN(s11);
		          if (string) {
		              var audio = new Audio(s11);
		              audio.play();
		          } else {}
		      } else if (ifnot) {
		          var _ifend = true;
		          var _ended = true;
		          //if name=johndoe 1
		          //name=johndoe 1
		          var s121 = current.split('=')[1]; //johndoe 1
		          var s122 = current.split('=')[0]; //if name
		          var s124 = s122.split(' ')[1]; //name
		          var s123 = s121.split(' ')[0]; //johndoe
		          var s125 = s121.split(' ')[1]; //johndoe
		          eval("if (" + s124 + " == '" + s123 + "') {_ifend=true;} else {_ifend=false;}");
		          if (ifend) {} else {
		              var ie4 = +s125 - 2;
		              i = ie4;
		          }
		      } else if (button) {
		          
		              // button [Hello!]=12
		              var s13 = current.substring(7);
		              var s131 = s13.split('=')[0]; // [hello]
		              var s132 = s13.split('=')[1]; // 12
		              document.getElementById('output').innerHTML = document.getElementById('output').innerHTML + "<p onclick='thei = " + eval("s132 - 1") + "; runcode(); frombutton = true;' class='noselect'>" + s131 + "</p>";
		              
						if (button) {

						} else {
						frombutton = false;
						}

		          
		      } else if (stop) {
		        return;
		      } else if (text && builder) {
		          var text_output;
		          // text Hello!=bold
		          var a1 = current.substring(5);
		          var a11 = a1.split('=')[0]; // Hello!
		          var a12 = a1.split('=')[1]; // bold
		          if (a12 == "bold") {
		              text_output = "<b>" + a11 + "<\/b>";
		          } else if (a12 == "plain") {
		              text_output = "<p>" + a11 + "<\/p>";
		          } else if (a12 == "italic") {
		              text_output = "<i>" + a11 + "<\/i>";
		          } else if (a12 == "underline") {
		              text_output = "<u>" + a11 + "<\/u>";
		          } else if (a12 == "heading") {
		              text_output = "<h1>" + a11 + "<\/h1>";
		          } else {
		              text_output = "<p>" + a12 + " is not an text style<\/p>";
		          }
		          document.getElementById('output').innerHTML = document.getElementById('output').innerHTML + text_output;
		          builder_compiled.push(text_output);
		      } else if (title && builder) {
		          var a2 = current.substring(6);
		          builder_compiled[1] = "<title>" + a2 + "<\/title>";
		          builder_compiled.push("<title>" + a2 + "<\/title>");
		      } else if (current == "line" && builder) {
		          document.getElementById('output').innerHTML = document.getElementById('output').innerHTML + "<hr style='border:1px solid black;' >";
		          builder_compiled.push("<hr style='border:1px solid black;' >");
		      } else if (image && builder) {
		          var a3 = current.substring(4);
		          document.getElementById('output').innerHTML = document.getElementById('output').innerHTML + "<img src=" + a3 + ">";
		          builder_compiled.push("<img src=" + a3 + ">");
		      } else if (wait) {
		          var s13 = current.substring(5);
		          sleep(+s13 * 1000);

		      } else if (current == "styles=on") {
		         builder = true;

		      } else {
		          var errorline = i + 1;
		          alert("Syntax error on line " + errorline + ".");
		          
		      }
		      // After commands:
		      lastcode = codelist;
		  }}

		function save() {
		  popup("<button onclick='save_corescript()'>Save as Corescript File<\/button><br>");
		}

		function save_corescript() {
		  codelist = $('#code').val().split('\n\n');

		  var projectname = prompt("File name:", "myproject");
		  download(projectname + ".corescript", codelist);

		}

		// File opener
		// File Downloader
		function download(filename, text) {
		  var element = document.createElement('a');
		  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
		  element.setAttribute('download', filename);
		  element.style.display = 'none';
		  document.body.appendChild(element);
		  element.click();
		  document.body.removeChild(element);
		}

		function checkforfile() {
		  var wll = window.location.href;
		  var wll1 = wll.includes("#");
		  if (wll1) {
		      var pasth = wll.split('#')[1];
		      document.getElementById('code').innerHTML = "";
		      document.getElementById('code').innerHTML = "";
		      var pasth1 = pasth.replace(/@break@/g, "\n");
		      document.getElementById('code').innerHTML = pasth1;
		      document.getElementById("outputbox").style.width = "100%";
		      runcode();
		  } else {}
		}

		checkforfile(); // Check if file is loaded in url.

		function random(num1, num2) {
		  return Math.floor(Math.random() * num2) + num1;
		}
		function sub(subtext,subnum) {
  var substringed = subtext.substring(subnum);
return substringed
}
		$(function() {
		  setInterval(update, 100);
		});

		function update() {
		  document.getElementById('codelines').innerHTML = "";
		  var codelist1 = $(code).val().split('\n');
		  for (q = 0; q < codelist1.length; q++) {
		      var q_ = q + 1;
		      document.getElementById('codelines').innerHTML = document.getElementById('codelines').innerHTML + "<span>" + q_ + "<\/span><br>";
		  }
		}
		$(function() {
		  setInterval(update2, 1);
		});

		function update2() {
		  document.querySelector('#lines').scrollTop = document.querySelector('#code').scrollTop;
		}
		$("document").ready(function() {
		  $("#fileInput").change(function() {
		      var file = document.getElementById("fileInput").files[0];
		      if (file) {
		          var reader = new FileReader();
		          reader.readAsText(file, "UTF-8");
		          reader.onload = function(evt) {
		              document.getElementById('code').innerHTML = "ololol";
		              document.getElementById("code").value = evt.target.result;
		          }
		          reader.onerror = function(evt) {
		              document.getElementById("code").value = "// Thats not a CoreScript file, silly.";
		          }
		      }
		  });
		});

		function share() {
		  var compiledshare = document.getElementById('code').value;
		  var compiledshare1 = compiledshare.replace(/\n/g, "@break@");
		  prompt("Share this link with your friends!", "https://corescript.neocities.org/editor/#" + compiledshare1);
		}
		var mystery = "You found the mystery variable!";

		function popup(text) {
		  document.getElementById('popup').style.visibility = "visible";
		  document.getElementById('popuptext').innerHTML = text;
		}

		function settings() {
		  popup("<center><br> <fieldset> <legend>Advanced Styles (Beta)<\/legend> <span>Enable <span title='( ͡° ͜ʖ ͡°)'>Corescript's<\/span> Advanced Styles Plugin: <\/span><input style='width: 30px;' type='checkbox' onclick='checkw()' id='website-c'> <br> <button onclick='preview_web()'>Preview Styles only<\/button> <\/fieldset> <\/center>");
		  document.getElementById("website-c").checked = builder;
		}
		/*

		*/
		function checkw() {
		  var checkw1 = document.getElementById("website-c").checked;
		  if (checkw1) {
		      builder = true;
		  } else {
		      builder = false;
		  }
		}

		function preview_web() {
		  var joined = builder_compiled.join("");
		  prompt("", "data:text/html, " + joined);
		}

		function load() {
		  var file = document.getElementById("plugin_file").files[0];
		  if (file) {
		      var reader = new FileReader();
		      reader.readAsText(file, "UTF-8");
		      reader.onload = function(evt) {
		          aaaa = evt.target.result;
		      }
		      reader.onerror = function(evt) {
		          alert("Error");
		      }
		  }
		}

		function textadd(tttt) {
		  document.getElementById('output').innerHTML = document.getElementById('output').innerHTML + tttt;
		}
		$(function() {
		  $("#popup").draggable({
		      handle: '#draggy'
		  });
		  $("#popup").draggable({
		      containment: "window"
		  });
		});

		function sleep(miliseconds) {
		  var currentTime = new Date().getTime();
		  while (currentTime + miliseconds >= new Date().getTime()) {}
		}

		function console(consoletext) {
		  document.getElementById("console").innerHTML = document.getElementById("console").innerHTML + "<p>" + consoletext + "<\/p>";
		}
		</script>
	</form>
	<style type="text/css">
#code {
	width: 50%;
	resize: none;
	height: 89.9%;
	font-size: 20px;
	font-family: times new roman;
	outline: none;
	background-color: lightgrey;
	border: 1px solid grey;
	float: left;
	font-family: sans-serif;
	position: absolute;
	top: 61px;
	left: 31px;
}
#outputbox {
	float: left;
	width: 47.25%;
	height: 90.5%;
	background-color: lightgrey;
	border: 1px solid grey;
	word-wrap: break-word;
	float: right;
	position: absolute;
	top: 61px;
	right: 0px;
}
body {
	background-color: white;
	overflow: hidden;
	color:#343a40;
}
#lines {
	float: left;
	width: 30px;
	border: 1px solid grey;
	height: 91.5%;
	background-color: lightgrey;
	font-size: 20px;
	overflow: hidden;
	position: absolute;
	top: 61px;
	height: 90.5%;
	left: 0px;
}
#runbutton {
	cursor: pointer;
}
.runbutton {
	width: 100px;
	height: 99%;
	border: transparent;
	background-color: transparent;
	font-size: 30px;
}
.runbutton:hover {
	background-color: darkgrey;
}
#runbutton:focus {
	outline: 0;
}
.runbutton2 {
	width: 100px;
	height: 99%;
	border: transparent;
	background-color: transparent;
	font-size: 30px;
}
.runbutton2:hover {
	background-color: darkgrey;
}
.runbutton3 {
	width: 100px;
	height: 99%;
	border: transparent;
	background-color: transparent;
	font-size: 30px;
}
.runbutton3:hover {
	background-color: darkgrey;
}
.runbutton4 {
	width: 100px;
	height: 99%;
	border: transparent;
	background-color: transparent;
	font-size: 30px;
}
.runbutton4:hover {
	background-color: darkgrey;
}
#popup {
	top: 30%;
	left: 36%;
	position: absolute;
	width: 400px;
	height: 200px;
	border: 1px solid white;
	background-color: white;
	visibility: hidden;
	resize: both;
    overflow: auto;
    min-width: 400px;
	min-height: 200px;
	resize: true;

    
}
#menu {
	border: 1px solid grey;
	background-color: #e0e0e0;
	width: 100%;
	height: 60px;
	position: absolute;
	top: 0px;
	left: 0px;

}
.close {
	float: right;
	background: transparent;
	border:transparent;
	outline: transparent;
}
.close:hover {
	border: 1px solid darkgrey;
	border-radius: 5px;

}
.noselect {
	-webkit-touch-callout: none;
	/* iOS Safari */
	-webkit-user-select: none;
	/* Safari */
	-khtml-user-select: none;
	/* Konqueror HTML */
	-moz-user-select: none;
	/* Firefox */
	-ms-user-select: none;
	/* Internet Explorer/Edge */
	user-select: none;
	/* Non-prefixed version, currently
                                  supported by Chrome and Opera */
	cursor: pointer;

}
.noselect:hover {
	background-color: white;
}
.runbutton5 {
	width: 120px;
	height: 99%;
	border: transparent;
	background-color: transparent;
	font-size: 30px;
}
.runbutton5:hover {
	background-color: darkgrey;
}
#settings {
	top: 15%;
	left: 18%;
	position: absolute;
	width: 800px;
	height: 400px;
	border: 1px solid white;
	background-color: white;
	visibility: hidden;
}

	</style>
	<div id="settings">
		<button class="close" onclick='document.getElementById("settings").style.visibility = "hidden";'>X</button> <!-- 
</fieldset>
    <br>
    <fieldset>
        <legend>Add Plugin (Unfinished)</legend>
        <p>Want to make your own plugin? Upload one here. You might want to read the <a href="google.com">documentary</a> first.</p>
        
        <input style="border: 1px solid black" type="file" id="plugin_file" multiple="false" accept=".js" type="file" value="Upload Javascript File">
        <br><br>
        <button onclick="load()">Load Plugin</button>
    </fieldset>
     -->
	</div><!-- Many lines of code! -->
</body>
</html>
